{{ with site.Data.config }}
  {{ $languages := dict }}

  {{ range $k, $lang := site.Data.options.langs }}
    {{ $language := dict }}
    {{ $base_url := "" }}
    {{ $enabled  := false }}
    {{ $paginate := false }}
    {{ $weight   := 0 }}

    {{ with index (where site.Data.config.langs "lang" $lang) 0 }}
      {{ $config  := . }}
      {{ $base_url = .baseURL }}
      {{ $enabled  = not (.disabled | default false) }}
      {{ $paginate = .paginate }}
      {{ with .types }}
        {{ range $type, $v := . }}

          {{/*  CONFIG TO TYPES / PARENTS / _INDEX PAGES  */}}
          {{ $default := dict }}
          {{ $path    := print "content." $lang "/" $type "/_index.md" }}
          {{ with resources.Get $path }}
            {{ with unmarshal .Content }}
              {{ $default = merge . (dict "type" $type) }}
            {{ end }}
          {{ end }}
          {{ $type_config := index $config.types $type | default dict }}
          {{ $type_obj    := merge $default $type_config }}
          {{ with $type_obj }}
            {{ $obj := dict 
              "title"          (.title       | default "")
              "title_seo"      (.title_seo   | default "")
              "description"    (.description | default "")
              "image"          (.image       | default "")
              "draft"          (.draft       | default false)
              "noindex"        (.noindex     | default false)
              "translationKey" (.type        | default "")
            }}
            {{ partial "file-by-obj" (dict "obj" $obj "content" (.content | default "") "path" $path) }}
          {{ end }}

          {{/*  CONFIG TO HUGO LANGUAGES  */}}
          {{ with $type_obj.permalinks }}{{ $language = merge $language (dict $lang (dict "permalinks" (dict "page"    (dict $type .)))) }}{{ end }}
          {{ with $type_obj.slug       }}{{ $language = merge $language (dict $lang (dict "permalinks" (dict "section" (dict $type .)))) }}{{ end }}

        {{ end }}
      {{ end }}
    {{ end }}

    {{ range $kw, $v := site.Data.config.langs }}
      {{ if eq $lang .lang }}
        {{ $weight = add $kw 1 }}
      {{ end }}
    {{ end }}

    {{ $languages = merge $languages $language }}
    {{ with $base_url }}{{ $languages = merge $languages (dict $lang (dict "baseURL"       .))  }}{{ end }}
    {{ with $paginate }}{{ $languages = merge $languages (dict $lang (dict "paginatePath"  .))  }}{{ end }}
    {{ with $enabled  }}{{ $languages = merge $languages (dict $lang (dict "disabled" (not .))) }}{{ end }}
    {{ with $weight   }}{{ $languages = merge $languages (dict $lang (dict "weight"        .))  }}{{ end }}

  {{ end }}

  {{ $obj := dict
    "defaultContentLanguage" ((index .langs 0).lang | default "es")
    "languages"              $languages
  }}
  {{ with .lang_default_subdir }}
    {{ $obj = merge $obj (dict "defaultContentLanguageInSubdir" .) }}
  {{ end }}
  {{ partial "file-by-obj" (dict "obj" $obj "path" "langs.yml") }}

{{ end }}

{{ return "" }}