{{ $config := partial "functions/config-lang" . }}

{{ $isCookies         := false -}}
{{ $isScrollShow      := false -}}
{{ $disqusId          := "" }}
{{ $isGoogleTranslate := false }}
{{ $googleAnalyticsId := "" }}
{{ $i18nVideo         := i18n "video" }}
{{ $lang              := page.Lang }}

{{ $custom       := (resources.Get "js/custom.js").Content -}}

{{ if site.Data.styles.performance.show }}
  {{ $isScrollShow = true -}}
{{ end }}

{{ if site.GetPage "pages/cookies" }}
  {{ $isCookies = true }}
{{ end }}

{{ with $config.disqus }}
  {{ $disqusId = . }}
{{ end }}

{{ if .menu.google_translate }}
  {{ $isGoogleTranslate = true }}
{{ end }}

{{ if hugo.IsProduction }}
  {{ with $config.google_analytics }}
    {{ $googleAnalyticsId = . }}
  {{ end }}
{{ end }}


{{ $opts := dict
  "targetPath" (print site.Home.RelPermalink "js/scripts.js")
  "params" (dict
    "isCookies"         $isCookies
    "isScrollShow"      $isScrollShow
    "disqusId"          $disqusId
    "isGoogleTranslate" $isGoogleTranslate
    "googleAnalyticsId" $googleAnalyticsId
    "i18nVideo"         $i18nVideo
    "lang"              $lang
    "custom"            $custom
    "formErrorSingleQuotes"   (i18n "form_error_single_quotes")
    "formErrorRequiredFields" (i18n "form_error_required_fields")
    "formErrorRequiredCheck"  (i18n "form_error_required_check")
    "formErrorEmail"          (i18n "form_error_email")
    "formErrorNumber"         (i18n "form_error_number")
    "formErrorFile"           (i18n "form_error_file")
    "formErrorAcept"          (i18n "form_error_acept")
    "formSubmitOk"            (i18n "form_submit_ok")
    "formSubmitWrong"         (i18n "form_submit_wrong")
  )
}}

{{ if hugo.IsProduction }}
  {{ $opts = merge $opts (dict "minify" true) }}
{{ end }}

{{ $js := resources.Get "js/_index.js"
  | resources.ExecuteAsTemplate "aux_scripts" $custom
  | js.Build $opts
  | fingerprint
}}

<script src="{{ $js.RelPermalink }}" defer></script>
