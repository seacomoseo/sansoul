{{ $s := newScratch }}
{{ $s.Set "filtered" dict }}
{{ range $k, $v := . }}
  {{ if ne $v nil }}
    {{ if reflect.IsMap $v }}
      {{ $sub := partial "func/obj-no-nil" $v }}
      {{ $s.SetInMap "filtered" $k $sub }}
    {{ else }}
      {{ $s.SetInMap "filtered" $k $v }}
    {{ end }}
  {{ end }}
{{ end }}
{{ return ($s.Get "filtered") }}