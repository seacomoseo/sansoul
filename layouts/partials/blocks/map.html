{{- $map := .map | default dict -}}
{{- with .geos -}}
  {{- $icons := slice -}}
  {{- /*  MAP  */}}
  {{- $map_attrs := dict
    "id"        (print "map-" ($.id | default $.section.id))
    "class"     "map box__block"
    "data-zoom" $map.zoom
    "data-tile" $map.tile
  -}}
  {{- $map_attrs = partial "func/attrs" $map_attrs }}
  <div {{- $map_attrs }}></div>
  <div class="map__next">
    {{- /*  EACH  */ -}}
    {{- range . -}}
      {{- $radius    := or .radius "" -}}
      {{- $color     := or .color $map.color $.icon_color "main" -}}
      {{- $icon      := or .icon $map.icon $.pin (partial "func/default-icon" "geo") -}}
      {{- $icon       = cond (ne .type "point") "" $icon -}}
      {{- $geo_attrs := dict
        "data-geo"    .geo
        "data-radius" $radius
        "data-color"  $color
        "data-icon"   $icon
      -}}
      {{- $geo_attrs = partial "func/attrs" $geo_attrs }}
      <div {{- $geo_attrs }}>{{ .label }}</div>
    {{- end }}
  </div>
{{- end -}}
